---
title: "Домашка №1"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

### Правила игры

* Эту домашку лучше делать в обычном скрипте (.R), не в RMarkdown. Если хотите делать пометки, то комментируйте их.
* Все задачи должны быть оформлены в виде функции! Если вы смогли решить задачу, но не смогли оформить ее в виде функции, то за это будет снято какое-то количество баллов.
* Запрещено пользоваться встроенными функциями, которые могут очень легко упростить решение задач, такие как `which`, `max`, `min`, `sort`, `sum`, `cummean`, `cumsum` и другие. Можете уточнить  про конкретную функцию.

### 1. Винни-Пух и Пятачок (20 баллов)

<center>
![](https://proprikol.ru/wp-content/uploads/2020/04/kartinki-vinni-puh-8-1.jpg){width=600px}
</center>

Винни-Пух и Пятачок нашли новый улей с мёдом. Чтобы дойти до него им нужно преодолеть ряд холмов. У каждого холма есть некоторая высота в метрах. Винни-Пух и Пятачок готовы подняться не более чем на `k` метров за весь путь, если нужно предолеть больше `k` метров, то за медом они не пойдут. Также Винни и Пятачок очень суеверные и боятся числа 13. Если есть хоть один холм с такой высотой, то за медом они тоже не пойдут. Нужно написать функцию, которая будет принимать необходимые данные и отвечать на вопрос: "Пойдут ли Винни и Пятачок за медом?".

* Например, `hills <- c(10, 12, 15, 3)`, `k <- 50`. Ответ: `TRUE`. То есть нужно преодолеть в сумме `10 + 12 + 15 + 3 = 40` метров.
* Например, `hills <- c(10, 2, 5, 3)`, `k <- 50`. Ответ: `TRUE`.
* Например, `hills <- c(10, 12, 13, 3)`, `k <- 50`. Ответ: `FALSE`.

### 2. Cumulative Mean (20 баллов)

Нужно написать функцию накопленного среднего. На вход идет массив, а дальше вы находите среднее от 1 до 1 элемента, от 1 до 2 элемента, от 1 до 3 элемента и так далее. То есть идете слева направо и находитк

* `x <- c(1, 2, 3, 4, 5)` => `c(1, 1.5, 2, 2.5, 3)`
* `x <- c(0, 1, 11, 12)` => `c(0, 0.5, 4, 6)`

Функцией `sum`, которую мы писали на паре, пользоваться тоже нельзя :)

### 3.NotAvailable (20 баллов)

Часто в данных мы можем наблюдать пропуски. Как мы говорили в R они заполняются с помощью `NA` (not available). Например, у нас может быть массив, содержащий доходы людей в тыс. рублей. Но некоторые люди не хотят делиться этой информации. Когда мы получили данные, мы бы хотели посмотреть хотя бы на одно нормальное наблюдение (которое не `NA`). Для этого напишите функцию, которая принимает на вход массив, и возвращает первое не `NA` значение. Если все элементы в массиве это `NA`, то выведите `NA`.

* `x <- c(NA, NA, NA, 30, NA, 20, 100)`, ответ: `30`
* `x <- c(NA, NA, NA, NA)`, ответ: `NA`

**Hint:**

С помощью функции `is.na()` можно убедиться является ли объект `NA` или нет.

```{r collapse=TRUE}
is.na(55)
is.na(NA)
``` 

### 4. Пьяный стрелок (40 баллов)

<center>
![](https://torrent-rose.ru/_ld/13/00291481.png){width=700px}
</center>

На диком западе живет очень точный ковбой. Его точность очень высока, вероятность попасть по мишени почти равна 1. Одним прекрасным вечером ковбой решил зайти в заведение "Тир и бар". Хорошенько выпил, а после решил пострелять. Бармен, работающий в этом заведении, хорошо знал ковбоя. Также он знал, что чем больше выпьет ковбой, тем хуже он стреляет. Поэтому предложил ему на выбор два варианта игры:

1. У ковбоя есть один выстрел. Попадает по мишени - выигрывает, не попадает - проигрывает.
2. Ковбою даётся 20 патронов, ему нужно попасть хотя бы по 7 мишеням. Но после каждого попадания, ковбой будет выпивать, следовательно, его точность будет уменьшаться.

Вы -- хороший друг ковбоя, который знает основа тервера, а также R, чтобы замоделировать ситуацию. Какой из вариантов ему стоит выбрать? Какой вариант вы бы выбрали, если бы вас просили ответить на вопрос без всяких вычислений (ответ никак не учитывается, просто интересна ваша интуиция)?

Что нужно сделать?

1. Введите переменную `p`, которая будет отвечать за точность ковбоя -- вероятность попасть по мишени. Для простоты пусть она будет равна `0.3`.
2. В первом варианте игру можно не моделировать. Вы сразу знаете вероятность победы ковбоя. Чему она равна?
3. Второй вариант игры вам нужно замоделировать. Для этого нужно написать функцию, которая принимает вероятность `p`, что ковбой попал по мишени. На выходе эта функция должна вывести 1 -- победа, 0 -- поражение. После каждого попадания ковбой пьет, и его точность уменьшается на 10% (`p <- p - p / 10`).
4. Найдите верояность победы при втором варианте?
5. Какой вариант вы посоветуете ковбою? Как думаете, на что рассчитывал бармен?

### Бонус (+15 баллов)

Переменная `p` в самом начале показывает насколько пьян ковбой перед тем как начинает играть. Возможно, если ее значение будет меняться (не будет уже равно 0.3), то ваш ответ на вопрос предыдущей задачи будет меняться.

Попробуйте посчитать вероятность победы для разных значений `p` и построить график: по оси `x` -- вероятность попадания по мишени, `y` -- вероятность победы в игре. На графике должно быть 2 линии, каждая должна отвечать за свой вариант игры.

Нарисовав график, какие выводы вы можете сделать?

**Hint:**

Вот так можно нарисовать простой график и наложить на его прямую линию:

```{r}
x <- seq(-4, 4, by = 0.25)
y <- sin(x)

plot(x, y, type = 'l', col = 'red')
lines(x, 0.5*x , col = 'green')
```



