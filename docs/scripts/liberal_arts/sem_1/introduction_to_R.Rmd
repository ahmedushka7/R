---
title: "Введение в R"
author: "Ахмедушка"
output: 
  html_document:
    toc: TRUE
    toc_float: TRUE
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, highlight = FALSE)
```

### Почему R?

R — язык программирования для статистической обработки данных и работы с графикой, но в тоже время это свободная программная среда с открытым исходным кодом. R применяется везде, где нужна работа с данными. Это не только статистика в узком смысле слова, но и «первичный» анализ (графики, таблицы), и продвинутое математическое моделирование.

### R как калькулятор

```{r}
#R можно использовать как калькулятор:3

2+2 # Сложение.

10-5 # Вычитание.

10*99 # Умножение.

225/15 # Деление, результат - целочисленный.

10/4 # Деление, результат - действительное число.

11%/%3 # Целая часть от деления.

11%%3 # Остаток от деления.

5^2 # Возведение в степень(1 вариант).

5**2 # Возведение в степень(2 вариант).

pi # Число Пи.

cos(pi) # Косинус.

sin(pi) # Синус.

exp(1) # Экспонента.

tan(0) # Тангентс.

abs(-5) # Модуль.

sqrt(144) #Корень.

round(3.4865,2) #Округление.

# Рассказать про Tab.

factorial(10) # Факториал.

# Рассказать про плюсик в консоле. 

# Закоментировать код можно с помощью команды Ctrl + Shift + C
# Сделать заголовок можно с помощью команды Ctrl + Shift + R



```



### Переменные


```{r}
#Переменные:3

a <- 5 # Теперь в а содержится цифра 5.
#Чтобы быстро сделать стрелочку можно воспользоваться Alt+тире.

b = 19 # Теперь b содержит цифру 7.
#Присваивать можно и с помощью равно,но как постоянно говорит Михаил Гареев:
#"КОД ДОЛЖЕН БЫТЬ КРАСИВЫМ!"

8 -> c # С помощью стрелочки можно присваивать и в обратную сторону,может кому-то будет удобнее.

#А теперь очень важное замечание!
#R отличает строчные и заглавные буквы!
M <- 99
m <- 66
#Это две разные переменные!

#Переменные могут иметь любое название.Например:
my_number <- 7

#Провести с переменными те же операции, что и с числами!

#Виды переменных:

#числовой(integer/numeric/double)
number <- 7

#строковый(character)
name <- "Anna"

#Логический(logical)
a <- TRUE
b <- FALSE

#typeof
#class()
#is.logical


#Поговорить про бесконечность,NA и NaN.
sila <- Inf

b <- 0/0 # Not-a-Number

a <- NA # not available

# Выводит на экран список объектов в текущем рабочем пространстве
ls()
# Удаляет один или несколько объектов из рабочего пространства
rm("список_объектов")
# Ctrl+L - Очищает окно Консоли от текста

#Очищает рабочее пространство
rm(list=ls())

readline()
print()
cat()

#==
#!=
#>
#<

0.1+0.2==0.3
all.equal(0.1+0.2,0.3)
```

### Массивы

```{r}
rm(list=ls())

# --------
# Прежде всего научимся пользоваться справкой.
# ?factorial
# или
# help(factorial)
# --------


# Массивы(векторы)
# Вектор - самая базовая структура данных в R.
# Вы можете создать вектор используя функцию c() которая объединяет несколько ОДНОТИПНЫХ элементов.
numbers <- c(1,2,3,4,5)
names <- c("Ahmed","Anna","Vika","Mikhael")
logic <- c(TRUE,FALSE,T,F)

#Взглянем в правой верхней части RStudio на то, как сохраняются вектора.
# Попробуем пропринтовать эти вектора.
print(numbers)
print(names)
print(logic)

# TRUE и FALSE это также 1 и 0, и наоборот.
logic <- as.numeric(logic)
print(logic)

# Вектор это индексируемый вид данных.
n1 <- numbers[1]
n2 <- numbers[2]
n3 <- numbers[3]

print(n1)
print(n2)
print(n3)

# Элементы вектора можно изменять.
numbers[1] <- 10
numbers[2] <- 11
numbers[3] <- 12

print(numbers)

# Функция length(x), где x - это сам вектор, считает количество элементов в нем.
chi <- c(0,0,0,0,0,0)
kol <- length(chi)
print(kol)

# Элементов получилось 6,но что будет если мы попробуем вывести 7-ой элемент.
print(chi[7])

# Как же добавить еще элементов в вектор?Просто создать новый вектор.
numbers <- c(numbers,10,13,99)
print(numbers)

# В данном случае мы можем вставить элементы в начало или конец.Если же нужно вставить элемент в определенное время используем функцию append.
numbers <- append(numbers,-Inf,after = 3)

# Добавлять научились, теперь научимся удалять.
numbers <- numbers[-1]

# Различные способы задания вектора
v1 <- 10:100
v2 <- seq(1, 2, by = 0.25)
v3 <- seq(5, 10, length = 20)
v4 <- rep(1:3,times = 5)
v5 <- rep(1:3,each = 4)

# Как выбирать какие-то определенные элементы из массива?
v1[c(1,3,5)]
v1[seq(1,5,2)]

# Хороший способ проверять свои скрипты, это давать рандомный вектор
# для проверки

random <- sample(x = 1:10, size = 5, replace = TRUE)
```


### Цикл for

```{r}
# Зачем нужны циклы? Представим, что вас попросили вывести на экран 
# последовательно 10 первых чисел массива. С текущими знаниями мы бы 
# сделали это следующим образом:
v <- random <- sample(x = 1:10, size = 15, replace = TRUE)
print(v[1])
print(v[2])
print(v[3])
print(v[4])
print(v[5])
print(v[6])
print(v[7])
print(v[8])
print(v[9])
print(v[10])

# Конструкция цикла for

for (variable in vector) {
  # здесь тело цикла
}

# Задача №1 (вывести 10 чисел массива с помощью цикла for)
for(i in 1:10){
  print(v[i])
}

# Задача №2 (вывести все числа массива)
n <- length(v)
for(i in 1:n){
  print(v[i])
}

# Задача №3 (есть 2 числа: a и b, нужно 
# вывести все целые числа,которые находятся между ними)
a <- 67
b <- 121
for(j in a:b){
  print(j)
}

# Задача №4 (вывести 15 нечетных чисел)
k <- 15
for(i in seq(1,k*2,2)){
  print(i)
}

# Задача №5 (сумма элементов массива)
s <- 0
for(i in 1:n){
  s <- s + v[i]
}
print(s)

# Задача №6 (факториал числа l)
# Факториал числа l = 1*2*3*...*l
f <- 1
l <- 6
for(i in 2:l){
  f <- f*i
}
print(f)

```


### Условный оператор if

```{r}
# Вот так выглядит полная конструкция if в R
if (condition) {
  # действия в случае TRUE 
}else{
  # действи в случае FALSE
}

# Задача №1. Даны 2 числа a и b. Нужно вывести на экран значение числа, которое больше.
a <- 5
b <- 15
if(a > b){
  print(a)
}else{
  print(b)
}

# Задача №2. Дано число. Нужно узнать положительное оно или отрицательное.



# Задача №3. Условие задачи 2, но теперь нужно определять, равно ли число нулю.



# Задача №4. Даны 3 числа: a,b и c. Нужно вывести на экран значение числа, которое больше.



# Задача №5. Даны 2 числа. Определить есть ли среди них хотя бы одно нечетное.



# Задача №6. Даны 2 числа. Определить являются ли они нечетными.


# Усовершенствование 5 и 6 задачи с помощью & и |. 


# Задача №7. Посчитать сумму всех четных элементов массива.


# Задача №8. Есть переменная action. Она может быть равна либо "Сложить", либо "Перемножить"
# В зависимости от этой переменной нужно сложить или перемножить все элементы массива.

```

### Цикл while и матрицы

```{r}
# Цикл while = for + if = "бесконечный" цикл.

a <- 0
while (a<5) {
  a <- a + 1
  print(a)
}

# R может сломаться, если вы используете while неправильно.

# while(5==5){
#   print(666)
# }

# Матрицы.  

# Способы задания.

m <- matrix(data = 0, nrow = 3, ncol = 5)
print(m)

m1 <- matrix(data = 1:15, nrow = 3, ncol = 5)
print(m1)

m2 <- matrix(data = 1:15, nrow = 3, ncol = 5, byrow = TRUE)
print(m2)

# Обращение к матрицам очень похоже на обращение к массивам. Но матрица имеет 
# 2 оси.

m2[1,5]
m2[3,2]

# Элементы матрицы можно менять.

m2[1,5] <- 7

# Можно обращаться к строке или столбцу.
m2[1,] # 1 строка
m2[,2] # 2 столбец
```

### Функция

```{r}
# Предположим у нас есть 3 массива. И нам нужно найти сумму каждого из них.
# Не зная, что такое функция, мы бы сделали следующим образом:

m1 <- 1:5
m2 <- 3:6
m3 <- c(-10,0,9)

s1 <- 0
s2 <- 0
s3 <- 0

for(i in 1:length(m1)){
  s1 <- s1 + m1[i]
}

for(i in 1:length(m2)){
  s2 <- s2 + m2[i]
}

for(i in 1:length(m3)){
  s3 <- s3 + m3[i]
}

print(s1)
print(s2)
print(s3)

# Если представить, что таких массивов будет болльше или мы будем находить 
# не сумму, а что-то другое(где код будет гораздо больше),то возникает проблема: 
# код занимает очень много места, хотя производится одна и та же операция, но с разными входными данными.
# Для решения данной проблемы была придумана функция.

SUM <- function(x){
  s <- 0
  for(i in 1:length(x)){
    s <- s + x[i]
  }
  return(s)
}

SUM(m1)
SUM(m2)
SUM(m3)

# Код значительно уменьшился. Попробуем сделать функцию, которая выводит квадрат числа.
f <- function(x){
  l <- x^2
  return(l)
}

f(5)

# А теперь улучшим предыдущую фукцию. На вход будет подаваться число и строковая переменная,
# которая равна либо "Куб" , либо "Квадрат"

f <- function(x,y){
  if(y == 'Квадрат'){
    l <- x^2
    return(l)
  }else{
    l <- x^3
    return(l)
  }
}

f(3,y = 'Куб')

# У многих функций, есть дефолтные параметры. Они нужны, чтобы уменьшить написание
# входных переменных функции. 

f <- function(x,y = 'Квадрат'){
  if(y == 'Квадрат'){
    l <- x^2
    return(l)
  }else{
    l <- x^3
    return(l)
  }
}

f(2)
f(2, y = 'Куб')

# Внутри каждой функции используются какие-то дополнительные переменные. Но их значение
# используется только внутри функции, поэтому такие переменные называются локальными.
# Переменные, которые мы видим в правом верхнем окошке являются глобальными.
# Можно сделать переменную глобальной внутри функции(но лучше этого не делать)
rm(list=ls())
f <- function(x){
  l <<- x^2
  return(l)
}

f(5)

# Поработаем теперь с return. Важно, что должна выводить функция.

k <- function(x){
  a <- x*5
  b <- x/5
  c <- x+5
  return(a)
}

# Выводить можно несколько чисел, с помощью массива.

k <- function(x){
  a <- x*5
  b <- x/5
  c <- x+5
  return(с(a,b,c))
}

# Напишем функцию факториала.
fact <- function(n) {
  k <- 1
  for(i in 2:n){
    k <- k*i
  }
  return(k)
}

# Теперь поговорим про рекурсию. Рекурсия - это функция, которая использует саму себя.
fact1 <- function(n){
  if(n == 1){
    return(1)
  }else{
    k <- fact1(n-1)
    return(n*k)
  }
}


```

### Семинар

```{r}
# Задача №1
# Дано число k. Нужно вывести треугольник с изчезающим первым значением.
# Например, k = 9, тогда вывод должен быть следующим:

# 9 8 7 6 5 4 3 2 1
# 8 7 6 5 4 3 2 1
# 7 6 5 4 3 2 1
# 6 5 4 3 2 1
# 5 4 3 2 1
# 4 3 2 1
# 3 2 1
# 2 1
# 1

k <- 10



# Задача №2
# Для настольной игры используются карточки с номерами от 1 до N. Одна карточка потерялась. 
# Найдите ее, зная номера оставшихся карточек.
# Подсказка: нужно найти сумму всех карточек, а потом найти сумму известных. Дальше вычесть одно из другого.
cards <- c(1,5,7,9,2,3,4,8)





# Задача №3
# По данному натуральном n вычислите сумму 1!+2!+3!+...+n!. 
# В решении этой задачи можно использовать только один цикл.
n <- 7 
```

