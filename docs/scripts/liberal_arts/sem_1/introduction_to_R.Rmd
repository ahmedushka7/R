---
title: "Введение в R (часть 1)"
author: "Ахмедушка"
output: 
  html_document:
    toc: TRUE
    toc_float: TRUE
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, highlight = FALSE,eval = FALSE)
```

### Почему R?

R — язык программирования для статистической обработки данных и работы с графикой, но в тоже время это свободная программная среда с открытым исходным кодом. R применяется везде, где нужна работа с данными. Это не только статистика в узком смысле слова, но и «первичный» анализ (графики, таблицы), и продвинутое математическое моделирование.

### Интерфейс RStudio

Интерфейс RStuidio состоит из четырёх основных окон:

* верхнее левое - работа со скриптами
* нижнее левое - работа с консолью
* верхнее правое - переменные, функции и остальные созданные объекты
* верхнее нижнее - директория, графики, пакеты и поддержка

### R как калькулятор

Начнем с простых aрифметических дейтсвий в R

```{r}
2+2 # Сложение.
10-5 # Вычитание.
10*99 # Умножение.
225/15 # Деление, результат - целочисленный.
10/4 # Деление, результат - действительное число.
11%/%3 # Целая часть от деления.
11%%3 # Остаток от деления.
5^2 # Возведение в степень(1 вариант).
5**2 # Возведение в степень(2 вариант).
```

Можно использовать простые функции из школьного курса. Мы еще поговорим про функции позже, но вы можете просто написать название функции, открыть скобки и написать необходимые аргументы через запятую. Названия функций бывают большими и каждый раз писать их бывает лень. Вы можете написать несколько первых букв и нажать TAB. R предложит вам различные варианты, которые можно выбрать стрелочкой.

```{r}
pi # Число Пи.
cos(pi) # Косинус.
sin(pi) # Синус.
exp(1) # Экспонента.
tan(0) # Тангентс.
abs(-5) # Модуль.
sqrt(144) #Корень.
round(3.4865,2) #Округление.
factorial(10) # Факториал.
```

Несколько моментов при работе с консолью:

* Если в консоле стоит значок `>`, это означает, что консоль готова к работе. Если выполнить код `2 * 3 *`, то в консоли появится плюсик(`+`). R предлагает вам дописать код. Вы можете либо дописать код, либо нажать *Esc* и ввести код заново.
* Стрелочками вверх и вниз можно переходить к коду, который был запущен ранее.

Работаю в скрипте можно комментировать код. Это можно сделать с помощью решетки `#`.Закоментировать код можно также с помощью команды Ctrl + Shift + C. Сделать заголовок можно с помощью команды Ctrl + Shift + R

### Переменные

Информацию нужно где-то хранить. Самым простым контейнером для хранения данных являются переменные. Их можно создавать следующим образом:

1. Пишите название переменной (оно не должно содержать пробелов и должно начинаться с буквы)
2. Ставите стрелочку(`<-`) или знак равно(`=`). Стрелочку можно поставить с помощью комбинации Alt + - . Предпочтительнее использовать стрелочку.
3. Написать значение, которое вы хотите присвоить.

```{r}
a <- 5 # Теперь в а содержится цифра 5.
b = 19 # Теперь b содержит цифру 7.
```

На самом деле можно присваивать и в обртаную сторону, но так код становится менее читабельным.

```{r}
8 -> c # С помощью стрелочки можно присваивать и в обратную сторону,может кому-то будет удобнее.
```

Чтобы отобразить переменную нужно написать её название или использовать функцию `print`.

```{r}
a
print(c)
```

А теперь очень важное замечание! R отличает строчные и заглавные буквы!

```{r}
M <- 99
m <- 66
#Это две разные переменные!
```

С переменными можно проводить те же действия, что и с числами.

Значением переменной может быть не только какое-то число. Рассмотрим основные виды переменных:

* числовой(integer/numeric/double)
* строковый(character) - записывается в кавычках
* логический(logical) - TRUE/FALSE

```{r}
#числовой(integer/numeric/double)
number <- 7
#строковый(character)
name <- "Anna"
#Логический(logical)
a <- TRUE
b <- FALSE
```

Тип переменной можно определиить с помощью следующих команд:

* `typeof`
* `class`
* семейство функций `is.*`, например, `is.logical`

```{r}
typeof(number)
typeof(name)
typeof(a)
```

Кроме основных типов переменных есть еще и особые:

* `Inf` - бесконечность
* `NA` - Not available
* `NaN` - Not-a-Number

```{r}
sila <- Inf
b <- 0/0 # Not-a-Number
a <- NA # not available
```

Чтобы вывести на экран все наши объекты можно использовать функцию `ls`. 

```{r}
ls()
```

Чтобы удалить отдельный объект можно использовать функцию `rm`.

```{r}
a <- 10
rm(a)
```

Чтобы удалить все ваши объекты есть два пути:

* запустить код `rm(list=ls())`
* нажать на метёлочку в правом верхнем углу

Также можно очистить консоль с помощью комбинации Ctrl + L.

### Help

Важно уметь пользоваться справкой. Есть несколько способов вызвать справку:

* `?facrorial`
* `help(factorial)`
* навести мышкой на функцию и нажать F1

### Массивы

Следующим контейнером хранения данных являются массивы (векторы). Самый простой способ задания массива это использование функции `c`. Массивы могут содержать данные любого типа. Но этот тип должен быть одним, то есть вы не можете иметь в массиве, например, числовое и строковое значение. Название массива должно удовлетворять таким же условиям, что и названия переменных.

```{r}
numbers <- c(1,2,3,4,5)
names <- c("Ahmed","Anna","Vika","Mikhael")
logic <- c(TRUE,FALSE,T,F)
```

Выведем эти переменные на экран.

```{r}
print(numbers)
print(names)
print(logic)
```

Массив это индексируемый вид данных. Можно выделять нужные нам элементы по индексам.

```{r}
n1 <- numbers[1]
n2 <- numbers[2]
n3 <- numbers[3]
print(n1)
print(n2)
print(n3)
```

Элементы вектора можно изменять.

```{r}
numbers[1] <- 10
numbers[2] <- 11
numbers[3] <- 12
print(numbers)
```

Функция `length(x)`, где x - это сам вектор, считает количество элементов в нем.

```{r}
chi <- c(0,0,0,0,0,0)
kol <- length(chi)
print(kol)
```

Элементов получилось 6, но что будет если мы попробуем вывести 7-ой элемент?

```{r}
print(chi[7])
```

Как же добавить еще элементов в вектор? Просто создать новый вектор.

```{r}
numbers <- c(numbers,10,13,99)
print(numbers)
```

В данном случае мы можем вставить элементы в начало или конец.Если же нужно вставить элемент в определенное время используем функцию `append`. Первый аргумент это массив, в который добавляем элемент. Второй аргумент это сам элемент. А третий аргумент это после какого аргумента нужно вставить элемент.

```{r}
numbers <- append(numbers, -Inf, after = 3)
numbers
```

Добавлять научились, теперь научимся удалять. Можно выделить массив без указанного элемента. 

```{r}
numbers <- numbers[-1]
```

Изучим еще несколько способов создания массивов.

```{r}
v1 <- 10:100
v2 <- seq(1, 2, by = 0.25)
v3 <- seq(5, 10, length = 20)
v4 <- rep(1:3,times = 5)
v5 <- rep(1:3,each = 4)
```

Можно выделять из массива не только один элемент, но и несколько. Просто нужно подать массив индексов, которые нам нужны.

```{r}
v1[c(1,3,5)]
v1[seq(1,5,2)]
```

Часто для проверки аргументов хорошо использовать рандомный массив. Его можно создать с помощью функции `sample`. Первый аргумент(`x`) это массив из которого можно генерировать значения. Второй(`size`) это размер генерируемого массива. А третий(`replace`) указывает можно ли повторять элементы.

```{r}
random <- sample(x = 1:10, size = 5, replace = TRUE)
```

### Условие(condition) и условный оператор if

Мы можем сравнивать элементы:

```{r}
5 == 5
5 != 5
5 > 5
5 < 5
5 >= 5
5 <= 5
```

Есть некоторый нюанс.

```{r}
0.1 + 0.2 == 0.3
1/49 * 49 == 1
```

Так происходит потому что в R есть точность до определенного знака. Чтобы избежать этого можно использовать функцию `all.equal`. 

```{r}
all.equal(0.1+0.2, 0.3)
```

Зачастую действие алгоритма или какого-то кода может зависеть от условия, Для этого нужен условный оператор. Он выглядет следующим образом.

```{r, eval=FALSE}
if (condition) {
  # действия в случае TRUE 
}else{
  # действи в случае FALSE
}
```

Условие(condition) должно принимать значения либо TRUE, либо FALSE. То есть иметь логический тип.

Задачи:

1. Даны 2 числа a и b. Нужно вывести на экран значение числа, которое больше.

```{r}
a <- 5
b <- 15
if(a > b){
  print(a)
}else{
  print(b)
}
```

2. Дано число. Нужно узнать положительное оно или отрицательное.

```{r}
a <- 5
if(a > 0){
  print("Положительное")
}else{
  print("Отрицательное")
}
```

3. Условие задачи 2, но теперь нужно определять, равно ли число нулю.

```{r}
if(a > 0){
  print("Положительное")
}else{
  if(a == 0){
    print('Равно 0')
  }else{
    print("Отрицательное")
  }
}
```

4. Даны 3 числа: a,b и c. Нужно вывести на экран значение числа, которое больше.

```{r}
a <- 4
b <- 7
c <- -10
if(a > b){
  if(a > c){
    print(a)
  }else{
    print(c)
  }
}else{
    if(b > c){
    print(b)
  }else{
    print(c)
  }
}
```

5. Даны 2 числа. Определить есть ли среди них хотя бы одно нечетное.

```{r}
a <- 5
b <- 6
if(a %% 2 == 1) {
  print('Есть')
}else{
  if(b %% 2 == 1){
    print("Есть")
  }else{
    print("Нет")
  }
}
```

6. Даны 2 числа. Определить являются ли они нечетными.

```{r}
if(a %% 2 == 0){
  print("Нет")
}else{
  if(b %% 2 == 0){
    print("Нет")
  }else{
    print("Да")
  }
}
```

Часто бывает полезным использовать сразу несколько условий, соединяя их знаками `&`(логическое И) и `|`(логическое ИЛИ). 

7. Усовершенствовать задачу 5 с помощью `&` и `|`.

```{r}
a <- 4
b <- 2
if(a %% 2 == 1 | b %% 2 == 1){
  print('Есть')
}else{
  print("Нет")
}
```

8. Усовершенствовать задачу 6 с помощью `&` и `|`.

```{r}
if(a %% 2 == 1 & b %% 2 == 1){
  print("Да")
}else{
  print("Нет")
}
```
