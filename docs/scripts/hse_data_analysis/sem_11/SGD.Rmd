---
title: "Ликбез по производной, градиент и метод градиентного спуска"
author: "Зарманбетов Ахмед"
output: 
  html_document:
    toc: TRUE
    toc_float: TRUE
    toc_depth: 4
    highlight: pygments
    #df_print: paged
editor_options: 
  chunk_output_type: console
---
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
```

```{r}
library(ggplot2)
library(tibble)
library(dplyr)
```

### Функция и ее производная

Вспомним, что **функция** -- это отображение одного множества в другое, но так, что каждому элементу одного множества соответствует один и только один элемент из другого множества. Записывается это так: $f: \mathbb{R}^n \rightarrow \mathbb{R}$. 

Вспомним простую функцию $y = x^2$. Давайте нарисуем её!

```{r}
square <- function(x){
  return(x^2)
}

df <- tibble(x = seq(-10, 10, by = 0.1),
             y = square(x))

ggplot(df, aes(x, y)) +
  geom_line()
```

В данном случае $y$ -- это функция от одной переменной $x$. На таком графике мы можем явно увидеть зависимость функции от ее аргумента. Видим, что минимум находится в точке $x = 0$. Чуть позже мы будем работать с функциями нескольких переменных.

Теперь вспомним что такое производная. Не будем лезть в тяжелую математику. Нам будет важно следующее определение. **Производная** -- скорость изменения функции в данной точке.

Вспомним некоторые производные:

1. $c' = 0, c = const$
2. $(x^n)'  = nx^{n-1}$
3. $(e^x)' = e^x$
4. $(\ln{x})' = \frac{1}{x}$ 
5. $(\sin{x})' = \cos{x}$
6. $(\cos{x})' = -\sin{x}$

А также некоторые свойства:

1. $(cf(x))' = cf'(x)$ -- константу можно вынести из под знака производной
2. $(f(x) + g(x))' = f'(x) + g'(x)$ -- производная суммы это сумма производных
3. $[f(g(x))]' = f'(g(x))g'(x)$ -- производная сложной функции

А теперь порешаем некоторые примеры, чтобы лучше с этим разобраться.

1. $y = 100$
2. $y = x^2$
3. $y = 5x$
4. $y = 10x^3$
5. $y = 4x + cos(x)$
6. $y = \ln(x^2)$
7. $y = (10 - 5x)^2$

Давайте возьмем функцию $y = x^2$. Представим, что мы находимся в точке $x_0 = 5$. Значение функции в этой точке равно 25.

```{r}
x0 <- 5
ggplot(df, aes(x, y)) +
  geom_line() + 
  geom_point(x = x0, y = square(x0), color = 'blue', size = 2)
```

Производная этой функции: $y' = 2x$. . Давайте найдем ее производную в этой точке.

```{r}
dev_square <- function(x){
  return(2*x)
}

dev_square(x0)
```

Производная в этой точке равна 10. Важное свойство производной состоит в том, что если производная положительна, то чтобы увеличить значение функции надо увеличивать значение аргумента. Аналогично, если мы хотим уменьшить значение функции, мы должны уменьшить аргумент. Если значение производной в точке отрицательно, то все ровно наоборот. 

Объединяя эти два случая получаем:

$x_0 = x_0 + sign(f'(x_0)) t$

Второй вопрос, а на сколько нужно увлечивать или уменьшать? Вернемся к этому позже.

<!-- ### Минимум функции от одного аргумента -->

